# Used in the GitHub Actions unit test CI workflow. auth can be the following values: basic, keycloak, oidc
unit:
  enabled: true
  matrix:
    - name: Management
      packages: identity common console
    - name: Orchestration
      packages: orchestration connectors optimize
    - name: Design
      packages: web-modeler

# Used in the GitHub Actions integration test CI workflow.
integration:
  vars:
    # Using the common test dir.
    tasksBaseDir: ../../../test/integration/scenarios
    valuesBaseDir: integration/scenarios
    chartsBaseDir: ../../../..
  case:
    pr:
      scenario:
        - name: elasticsearch
          enabled: true
          auth: keycloak
          shortname: eske
          exclude: []
          infra-type:
            gke: distroci
            eks: preemptible
          platforms: [gke,eks]
        - name: upgrade-migration
          enabled: true
          flow: upgrade-minor
          auth: keycloak
          shortname: eske-upgm
          exclude: []
          infra-type:
            gke: distroci
            eks: preemptible
        - name: elasticsearch-basic
          enabled: false
          shortname: esba
          auth: basic
          flow: install
          identity: basic
          persistence: elasticsearch
          exclude: [identity,console,orchestration-grpc]
          infra-type:
            gke: distroci
            eks: preemptible
        - name: oidc
          enabled: true
          exclude: [identity,console,orchestration-grpc]
          shortname: esoi
          auth: oidc
          flow: upgrade-minor
          infra-type:
            gke: distroci
            eks: preemptible
          identity: oidc
          persistence: elasticsearch
        - name: keycloak-mt
          enabled: true
          exclude: []
          shortname: kemt
          auth: keycloak
          identity: keycloak-external
          persistence: elasticsearch-external
          flow: upgrade-minor
          infra-type:
            gke: distroci
            eks: preemptible
        - name: keycloak-rba
          enabled: true
          exclude: []
          shortname: kerba
          auth: keycloak
          flow: upgrade-minor
          infra-type:
            gke: distroci
            eks: preemptible
          identity: keycloak
          persistence: elasticsearch
          features: [rba]
        - name: keycloak-original
          enabled: true
          exclude: []
          shortname: keyc
          auth: keycloak
          flow: upgrade-minor
          infra-type:
            gke: distroci
            eks: preemptible
          identity: keycloak-external
          persistence: elasticsearch-external
        - name: elasticsearch
          enabled: true
          exclude: [orchestration-grpc]
          shortname: eshy
          auth: hybrid
          flow: install
          infra-type:
            gke: distroci
            eks: preemptible
        - name: elasticsearch-arm
          enabled: true
          auth: keycloak
          shortname: esarm
          exclude: []
          infra-type:
            gke: arm
          flow: install
    nightly:
      scenario:
        - name: elasticsearch
          enabled: true
          exclude: []
          shortname: eskey
          auth: keycloak
          # The following integration tests need to be exluded when basic-auth is enabled.
        - name: elasticsearch-basic
          enabled: true
          auth: basic
          shortname: esba
          identity: basic
          persistence: elasticsearch
          exclude: [identity,console,orchestration-grpc]
          # deployment should work but integration tests are not passing
        - name: elasticsearch-oidc
          enabled: false
          exclude: []
          shortname: esoi
          auth: oidc
          identity: oidc
          persistence: elasticsearch
        - name: multitenancy
          enabled: true
          shortname: mtke
          exclude: []
          auth: keycloak
          identity: keycloak-external
          persistence: elasticsearch
          features: [multitenancy]
          # not supported
        - name: opensearch
          enabled: false
          exclude: []
          shortname: oske
          auth: keycloak
        - name: opensearch
          enabled: true
          shortname: osba
          exclude: [identity,console,orchestration-grpc]
          auth: basic
          identity: basic
          persistence: opensearch
        - name: identity-migration
          enabled: true
          exclude: []
          shortname: idmike
          auth: keycloak
        - name: elasticsearch
          enabled: true
          exclude: []
          auth: basic
          shortname: elbae
          enterprise: true
        - name: documentstore
          enabled: false
          exclude: []
          shortname: docstr
          auth: keycloak
          identity: keycloak
          persistence: elasticsearch
          features: [documentstore]
        - name: keycloak-external-mimic
          enabled: true
          exclude: []
          shortname: kcextm
          auth: keycloak
