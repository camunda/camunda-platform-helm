# External Elasticsearch backend configuration for 8.7
# Layer 3: Backend - Elasticsearch (external)
#
# This layer configures an external Elasticsearch instance instead of the
# bundled one. Used by scenarios like keycloak-original that need external ES.

global:
  elasticsearch:
    enabled: true
    external: true
    prefix: $ORCHESTRATION_INDEX_PREFIX-$FLOW
    auth:
      username: elastic
      existingSecret: infra-credentials
      existingSecretKey: elasticsearch-password
    url:
      protocol: https
      host: elasticsearch-21-6-3-pool-${ES_POOL_INDEX}.ci.distro.ultrawombat.com
      port: 443

operate:
  env:
    - name: CAMUNDA_OPERATE_ELASTICSEARCH_INDEXPREFIX
      value: $OPERATE_INDEX_PREFIX-$FLOW
    - name: CAMUNDA_OPERATE_ZEEBEELASTICSEARCH_INDEXPREFIX
      value: $ORCHESTRATION_INDEX_PREFIX-$FLOW

optimize:
  env:
    - name: CAMUNDA_OPTIMIZE_ELASTICSEARCH_SETTINGS_INDEX_PREFIX
      value: $OPTIMIZE_INDEX_PREFIX-$FLOW
    - name: CAMUNDA_OPTIMIZE_ZEEBE_NAME
      value: $ORCHESTRATION_INDEX_PREFIX-$FLOW

zeebe:
  broker:
    exporters:
      elasticsearch:
        index:
          prefix: "$ORCHESTRATION_INDEX_PREFIX-$FLOW"
  env:
    - name: ZEEBE_BROKER_EXPORTERS_ELASTICSEARCH_ARGS_INDEX_PREFIX
      value: $ORCHESTRATION_INDEX_PREFIX-$FLOW

tasklist:
  env:
    - name: CAMUNDA_TASKLIST_ELASTICSEARCH_INDEXPREFIX
      value: $TASKLIST_INDEX_PREFIX-$FLOW
    - name: CAMUNDA_TASKLIST_ZEEBEELASTICSEARCH_INDEXPREFIX
      value: $ORCHESTRATION_INDEX_PREFIX-$FLOW

elasticsearch:
  enabled: false
